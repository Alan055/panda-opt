webpackJsonp([8],{"1rYy":function(e,t){},"7oS/":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("mvHQ"),n=a.n(s),l=a("Xxa5"),i=a.n(l),r=a("exGp"),o=a.n(r),v=a("7+uW"),u=(a("mtWM"),{name:"OperationalEvents",data:function(){return{addEventsFormRules:{eventstep:[{required:!0,message:"请选环节",trigger:"change"}],eventtype:[{required:!0,message:"请选择用户状态",trigger:"change"}]},eventTab:[{title:"运营事件列表",name:"1",type:"list"}],labelWidth:"120px",showAddBtn:!0,eventsTabIndex:"1",tabIndex:1,eventsList:{},defaultSize:{pageSize:10,pageNumber:1},timePart:[{value:"-10",label:"T-10"},{value:"-9",label:"T-9"},{value:"-8",label:"T-8"},{value:"-7",label:"T-7"},{value:"-6",label:"T-6"},{value:"-5",label:"T-5"},{value:"-4",label:"T-4"},{value:"-3",label:"T-3"},{value:"-2",label:"T-2"},{value:"-1",label:"T-1"},{value:"0",label:"T"},{value:"1",label:"T+1"},{value:"2",label:"T+2"},{value:"3",label:"T+3"},{value:"4",label:"T+4"},{value:"5",label:"T+5"},{value:"7",label:"T+7"},{value:"14",label:"T+14"},{value:"15",label:"T+15"},{value:"30",label:"T+30"},{value:"50",label:"T+50"},{value:"120",label:"T+120"}],allTime:[{value:"00:00:00",label:"00:00:00"},{value:"00:30:00",label:"00:30:00"},{value:"00:59:59",label:"00:59:59"},{value:"01:30:00",label:"01:30:00"},{value:"01:59:59",label:"01:59:59"},{value:"02:30:00",label:"02:30:00"},{value:"02:59:59",label:"02:59:59"},{value:"03:30:00",label:"03:30:00"},{value:"03:59:59",label:"03:59:59"},{value:"04:30:00",label:"04:30:00"},{value:"04:59:59",label:"04:59:59"},{value:"05:30:00",label:"05:30:00"},{value:"05:59:59",label:"05:59:59"},{value:"06:30:00",label:"06:30:00"},{value:"06:59:59",label:"06:59:59"},{value:"07:30:00",label:"07:30:00"},{value:"07:59:59",label:"07:59:59"},{value:"08:30:00",label:"08:30:00"},{value:"08:59:59",label:"08:59:59"},{value:"09:30:00",label:"09:30:00"},{value:"09:59:59",label:"09:59:59"},{value:"10:30:00",label:"10:30:00"},{value:"10:59:59",label:"10:59:59"},{value:"11:30:00",label:"11:30:00"},{value:"11:59:59",label:"11:59:59"},{value:"12:30:00",label:"12:30:00"},{value:"12:59:59",label:"12:59:59"},{value:"13:30:00",label:"13:30:00"},{value:"13:59:59",label:"13:59:59"},{value:"14:30:00",label:"14:30:00"},{value:"14:59:59",label:"14:59:59"},{value:"15:30:00",label:"15:30:00"},{value:"15:59:59",label:"15:59:59"},{value:"16:30:00",label:"16:30:00"},{value:"16:59:59",label:"16:59:59"},{value:"17:30:00",label:"17:30:00"},{value:"17:59:59",label:"17:59:59"},{value:"18:30:00",label:"18:30:00"},{value:"18:59:59",label:"18:59:59"},{value:"19:30:00",label:"19:30:00"},{value:"19:59:59",label:"19:59:59"},{value:"20:30:00",label:"20:30:00"},{value:"20:59:59",label:"20:59:59"},{value:"21:30:00",label:"21:30:00"},{value:"21:59:59",label:"21:59:59"},{value:"22:30:00",label:"22:30:00"},{value:"22:59:59",label:"22:59:59"},{value:"23:30:00",label:"23:30:00"},{value:"23:59:59",label:"23:59:59"}],channelOption:[{value:"1",label:"短信"},{value:"2",label:"App push"},{value:"3",label:"APP站内消息"},{value:"4",label:"自动电话"}],getDisabled:!0,userStatusList:[],searchText:"",channelSelect:"",timePartSelect:"",allTimePre:"",allTimeNext:"",runingTimePre:"",runingTimeNext:""}},computed:{linkList:function(){return[{value:"PART1",label:"PART1"},{value:"PART2",label:"PART2"},{value:"PART3",label:"PART3"},{value:"PART4",label:"PART4"},{value:"PART5",label:"PART5"},{value:"PART6",label:"PART6"}]},selectLoanstep:function(){return function(e){for(var t=[],a=0;a<this.userStatusList.length;a++)e==this.userStatusList[a].eventstep&&t.push(this.userStatusList[a]);return t}}},methods:{formatStatus:function(e,t){return 0==e.status?"停用":"正常"},handleSizeChange:function(e){this.defaultSize.pageSize=e,this.getSysEventlListById()},handleCurrentChange:function(e){this.defaultSize.pageNumber=e,this.getSysEventlListById()},handleStop:function(e,t){var a=this,s=1==t.status?"停用":"启用";this.$confirm("此操作将"+s+'运营事件 "'+e+'" 是否继续?',"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){a.Api.perModUserStatus({id:t.id,status:1==t.status?"0":"1"}).then(function(e){200==e.data.code?(a.$message({type:"success",message:s+"成功!"}),a.$store.dispatch("changeUserList",a.userListParams)):a.$message.error(e.data.msg)})}).catch(function(){a.$message({type:"info",message:"已取消"+s})})},init:function(){this.getSysEventlListById(),this.getSysEventlUserStatus()},getSysEventlListById:function(){var e=this,t={pageSize:this.defaultSize.pageSize,pageNumber:this.defaultSize.pageNumber,configtype:0,keyword:this.searchText,messagetype:this.channelSelect,triggerstarttime:this.runingTimePre,triggerendtime:this.runingTimeNext};""!=this.timePartSelect&&(t.timedirection=this.timePartSelect<0?1:0,t.triggerday=Math.abs(this.timePartSelect)),this.timePartSelect&&"0"!=this.timePartSelect&&(t.starttime=this.allTimePre,t.endtime=this.allTimeNext),console.log(t),this.Api.msGetSysEventlListById(t).then(function(t){200==t.data.code?e.eventsList=t.data.data||{}:e.$message.error(t.data.msg)})},download:function(){var e=this;return o()(i.a.mark(function t(){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a={pageSize:e.defaultSize.pageSize,pageNumber:e.defaultSize.pageNumber,configtype:0,keyword:e.searchText,messagetype:e.channelSelect,triggerstarttime:e.runingTimePre,triggerendtime:e.runingTimeNext},""!=e.timePartSelect&&(a.timedirection=e.timePartSelect<0?1:0,a.triggerday=Math.abs(e.timePartSelect)),e.timePartSelect&&"0"!=e.timePartSelect&&(a.starttime=e.allTimePre,a.endtime=e.allTimeNext),e.Down(a,"/opt/sysEvent/exportOptEventMessageList");case 4:case"end":return t.stop()}},t,e)}))()},getSysEventlUserStatus:function(){var e=this;this.Api.msGetSysEventlUserStatus({}).then(function(t){200==t.data.code&&(e.userStatusList=t.data.data)})},addEvents:function(e,t,a){var s=++this.tabIndex+"";if("add"==t)this.eventTab.push({title:"新增运营事件",name:s,type:"add",addEventsForm:{eventtype:"",messageEventsBeanList:[{messageEventsBeanList:[{messagetype:"",messageid:"",content:""}]}]}}),this.showAddBtn=!1;else if(a){var l=JSON.parse(n()(a.row));console.log("324324"),console.log(l);for(var i=0;i<l.length;i++);this.eventTab.push({title:"编辑运营事件"+(a.$index+1),name:s,type:"edit",addEventsForm:l})}this.eventsTabIndex=s},removeTab:function(e){var t=this,a=this.eventTab,s=this.eventsTabIndex;a.forEach(function(n,l){if(n.name===e)if("add"==n.type){var i=a[l+1]||a[l-1];i&&(s=i.name),t.showAddBtn=!0}else{var r=a[l+1]||a[l-1];r&&(s=r.name)}}),this.eventsTabIndex=s,this.eventTab=a.filter(function(t){return t.name!==e})},setDisabled:function(e,t,a,s){var n=this;if(this.getDisabled){this.getDisabled=!1;var l=1==e.status?"禁用":"启用";this.$confirm("此操作将"+l+"该渠道 ， 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){n.Api.msUpdateIsProhibit({id:e.id,status:1==e.status?"0":"1"}).then(function(l){200==l.data.code?(n.eventsList.list[s].messageEventsBeanList[t].messageEventsBeanList[a].status=1==e.status?"0":"1",n.getDisabled=!0):(n.getDisabled=!0,n.$message.error(l.data.msg))})}).catch(function(){n.$message({type:"info",message:"已取消"+l}),n.getDisabled=!0})}},setABtest:function(e,t,a,s){var n=this,l=1==e.abtest?"停用":"开启";this.$confirm("此操作将"+l+"该渠道ABtest， 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){n.Api.msUpdateAbtestById({id:e.id,abtest:1==e.abtest?"0":"1"}).then(function(l){200==l.data.code?n.eventsList.list[s].messageEventsBeanList[t].messageEventsBeanList[a].abtest=1==e.abtest?"0":"1":n.$message.error(l.data.msg)})}).catch(function(){n.$message({type:"info",message:"已取消"+l})})},deleteChannel:function(e,t,a,s){var n=this;this.$confirm("此操作将删除该渠道， 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error",center:!0}).then(function(){n.Api.msDeleteEventById({id:e.id}).then(function(e){200==e.data.code?n.eventsList.list[s].messageEventsBeanList[t].messageEventsBeanList.splice(a,1):n.$message.error(e.data.msg)})}).catch(function(){n.$message({type:"info",message:"已取消删除"})})},addAllocation:function(e){this.eventTab[e].addEventsForm.messageEventsBeanList.push({messageEventsBeanList:[{messagetype:"",messageid:"",content:""}]})},deleteAllocation:function(e,t){this.eventTab[e].addEventsForm.messageEventsBeanList.splice(t,1)},addBeanList:function(e,t){console.log(t),this.eventTab[t].addEventsForm.messageEventsBeanList[e].messageEventsBeanList.push({messagetype:"",messageid:"",content:""})},deleteBeanList:function(e,t,a){this.eventTab[t].addEventsForm.messageEventsBeanList[e].messageEventsBeanList.splice(a,1)},getSysEventDetailById:function(e,t,a,s){var n=this;if(!(e&&e.length>=18))return!1;this.Api.msGetSysEventDetailById({id:e}).then(function(e){200==e.data.code?e.data.data&&n.eventTab[a].addEventsForm.messageEventsBeanList[t].messageEventsBeanList[s].messagetype==e.data.data.messagetype?(n.eventTab[a].addEventsForm.messageEventsBeanList[t].messageEventsBeanList[s].content=e.data.data.content?e.data.data.content:e.data.data.templateid,n.eventTab[a].addEventsForm.messageEventsBeanList[t].messageEventsBeanList[s].messagetypeNew=e.data.data.messagetype):n.$message.error("渠道id不正确或者消息类型不匹配"):n.$message.error(e.data.msg)})},saveSysEvent:function(e,t){var a=this;this.$refs[t][0].validate(function(t){if(!t)return!1;var s=0,l=0,i="";"add"==a.eventTab[e].type?a.eventTab[e].addEventsForm.type="2":a.eventTab[e].addEventsForm.type="1";for(var r=a.eventTab[e].addEventsForm,o=0;o<a.eventTab[e].addEventsForm.messageEventsBeanList.length;o++)for(var u=0;u<a.eventTab[e].addEventsForm.messageEventsBeanList[o].messageEventsBeanList.length;u++)l++,r.messageEventsBeanList[o].triggerday?r.messageEventsBeanList[o].starttime?r.messageEventsBeanList[o].endtime?r.messageEventsBeanList[o].starttime.split(":")[0]>r.messageEventsBeanList[o].endtime.split(":")[0]?(v.default.set(r.messageEventsBeanList[o],"isError",!0),v.default.set(r.messageEventsBeanList[o],"errorText","开始时间不能大于结束时间"),i="开始时间不能大于结束时间"):r.messageEventsBeanList[o].starttime.split(":")[0]==r.messageEventsBeanList[o].endtime.split(":")[0]&&r.messageEventsBeanList[o].starttime.split(":")[1]>=r.messageEventsBeanList[o].endtime.split(":")[1]?(v.default.set(r.messageEventsBeanList[o],"isError",!0),v.default.set(r.messageEventsBeanList[o],"errorText","开始时间不能大于结束时间"),i="开始时间不能大于结束时间"):r.messageEventsBeanList[o].triggertime?r.messageEventsBeanList[o].messageEventsBeanList[u].messagetype?!r.messageEventsBeanList[o].messageEventsBeanList[u].messageid||r.messageEventsBeanList[o].messageEventsBeanList[u].messageid.length<18?(v.default.set(r.messageEventsBeanList[o],"isError",!1),v.default.set(r.messageEventsBeanList[o].messageEventsBeanList[u],"isError",!0),v.default.set(r.messageEventsBeanList[o].messageEventsBeanList[u],"errorText","请输入正确的渠道id"),i="请输入正确的渠道id"):(v.default.set(r.messageEventsBeanList[o].messageEventsBeanList[u],"isError",!1),v.default.set(r.messageEventsBeanList[o].messageEventsBeanList[u],"errorText",""),i="",s++):(v.default.set(r.messageEventsBeanList[o],"isError",!1),v.default.set(r.messageEventsBeanList[o],"errorText",""),v.default.set(r.messageEventsBeanList[o].messageEventsBeanList[u],"isError",!0),v.default.set(r.messageEventsBeanList[o].messageEventsBeanList[u],"errorText","请选择配置渠道"),i="请选择配置渠道"):(v.default.set(r.messageEventsBeanList[o],"isError",!0),v.default.set(r.messageEventsBeanList[o],"errorText","请选择跑批时间段"),i="请选择跑批时间段"):(v.default.set(r.messageEventsBeanList[o],"isError",!0),v.default.set(r.messageEventsBeanList[o],"errorText","请选择结束时间"),i="请选择结束时间"):(v.default.set(r.messageEventsBeanList[o],"isError",!0),v.default.set(r.messageEventsBeanList[o],"errorText","请选择开始时间"),i="请选择开始时间"):(v.default.set(r.messageEventsBeanList[o],"isError",!0),v.default.set(r.messageEventsBeanList[o],"errorText","请选择配置时间段"),i="请选择配置时间段");if(s!=l)return a.$message.error(i),!1;for(var c=0;c<r.messageEventsBeanList.length;c++)Number(r.messageEventsBeanList[c].triggerday)>=0?r.messageEventsBeanList[c].timedirection="0":r.messageEventsBeanList[c].timedirection="1";var d={id:r.id,configtype:0,eventstep:r.eventstep,eventtype:r.eventtype,messageEventsBeanList:r.messageEventsBeanList};a.Api.msSaveSysEvent({data:n()(n()(d)),type:r.type}).then(function(e){200==e.data.code?(a.removeTab(a.eventsTabIndex),a.$message.success("保存成功"),a.getSysEventlListById()):a.$message.error(e.data.msg)})})}},created:function(){this.init()},filters:{filterABtest:function(e){return 1==e?"关闭ABtest":"开启ABtest"},filterStatus:function(e){return 0==e?"启用":"禁用"},filterMessage:function(e){switch(e){case"1":return"短信";case"2":return"App push";case"3":return"APP站内消息";case"4":return"自动电话"}},filterTriggerDay:function(e,t){return e<0?"T"+e:"T+"+e}}}),c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"operation-view"},[a("transition",{attrs:{name:"el-zoom-in-bottom"}},[a("div",[e.showAddBtn?a("div",{staticClass:"add-btn",on:{click:function(t){e.addEvents(e.eventsTabIndex,"add")}}},[a("i",{staticClass:"el-icon-lx-roundadd"}),e._v("新增运营模块\n      ")]):e._e(),e._v(" "),a("el-tabs",{attrs:{type:"card",closable:""},on:{"tab-remove":e.removeTab},model:{value:e.eventsTabIndex,callback:function(t){e.eventsTabIndex=t},expression:"eventsTabIndex"}},e._l(e.eventTab,function(t,s){return a("el-tab-pane",{key:t.name,attrs:{label:t.title,name:t.name}},[a("div",{staticClass:"events-item"},["list"==t.type?a("div",[a("div",{staticClass:"plugins-search"},[a("el-form",{staticClass:"formTop",attrs:{inline:!0}},[a("div",[a("el-form-item",{attrs:{label:"搜索："}},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入内容"},model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"配置渠道："}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.channelSelect,callback:function(t){e.channelSelect=t},expression:"channelSelect"}},e._l([{label:"全部",value:""}].concat(e.channelOption),function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"配置时间段："}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.timePartSelect,callback:function(t){e.timePartSelect=t},expression:"timePartSelect"}},e._l([{label:"全部",value:""}].concat(e.timePart),function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),e._v(" "),e.timePartSelect&&"0"!=e.timePartSelect?a("div",{staticStyle:{display:"inline-block"}},[a("el-select",{attrs:{placeholder:"请选择开始时间"},model:{value:e.allTimePre,callback:function(t){e.allTimePre=t},expression:"allTimePre"}},e._l(e.allTime,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),e._v(" "),a("el-select",{attrs:{placeholder:"请选择结束时间"},model:{value:e.allTimeNext,callback:function(t){e.allTimeNext=t},expression:"allTimeNext"}},e._l(e.allTime,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],1):e._e()],1),e._v(" "),a("br"),e._v(" "),a("el-form-item",{attrs:{label:"跑批时间："}},[a("el-select",{attrs:{placeholder:"请选择开始时间"},model:{value:e.runingTimePre,callback:function(t){e.runingTimePre=t},expression:"runingTimePre"}},e._l(e.allTime,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),e._v(" "),a("el-select",{attrs:{placeholder:"请选择结束时间"},model:{value:e.runingTimeNext,callback:function(t){e.runingTimeNext=t},expression:"runingTimeNext"}},e._l(e.allTime,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.defaultSize.pageNumber=1,e.getSysEventlListById()}}},[e._v("搜索\n                      ")]),e._v(" "),a("el-button",{attrs:{type:"warning"},on:{click:function(t){e.download()}}},[e._v("导出")])],1)],1)])],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.eventsList.list}},[a("el-table-column",{attrs:{prop:"events",type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"solt-channel"},e._l(t.row.messageEventsBeanList,function(s,n){return a("div",{key:n,staticClass:"slot-channel"},[a("el-form",{attrs:{"label-position":"right",inlineclass:"demo-table-expand"}},[a("div",{staticClass:"inline-div",staticStyle:{width:"63%"}},[a("el-form-item",{attrs:{label:"配置时间段：","label-width":e.labelWidth}},[a("span",{staticClass:"border"},[e._v(e._s(e._f("filterTriggerDay")(s.triggerday,s.timedirection)))]),e._v(" "),a("span",{staticClass:"border"},[e._v(e._s(s.starttime||"无")+" 至\n                                                                  "+e._s(s.endtime||"无"))])])],1),e._v(" "),a("div",{staticClass:"inline-div inline-small"},[a("el-form-item",{attrs:{label:"跑批时间：","label-width":e.labelWidth}},[a("span",{staticClass:"border"},[e._v(e._s(s.triggertime||"无"))])])],1),e._v(" "),e._l(s.messageEventsBeanList,function(s,l){return a("div",{key:l,class:["item-material",0==s.status?"disabled":""]},[a("div",{staticClass:"inline-div inline-small"},[a("el-form-item",{attrs:{label:"配置渠道：","label-width":e.labelWidth}},[a("span",{staticClass:"border"},[e._v(e._s(e._f("filterMessage")(s.messagetype)))])])],1),e._v(" "),a("div",{staticClass:"inline-div "},[a("el-form-item",{attrs:{label:"渠道ID：","label-width":e.labelWidth}},[a("span",{staticClass:"border"},[e._v(e._s(s.messageid||"无"))])])],1),e._v(" "),a("el-form-item",{attrs:{label:"内容：","label-width":e.labelWidth}},[a("span",{staticClass:"border"},[e._v(e._s(s.content||s.templateid||"无")+"\n                              ")])]),e._v(" "),a("div",{staticClass:"slot-operation"},[a("el-button",{attrs:{type:"primary",size:"mini",plain:1==s.status},on:{click:function(a){e.setDisabled(s,n,l,t.$index)}}},[e._v("\n                                "+e._s(e._f("filterStatus")(s.status))+"\n                              ")]),e._v(" "),a("el-button",{attrs:{type:"warning",size:"mini",plain:1==s.abtest},on:{click:function(a){e.setABtest(s,n,l,t.$index)}}},[e._v("\n                                "+e._s(e._f("filterABtest")(s.abtest))+"\n                              ")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){e.deleteChannel(s,n,l,t.$index)}}},[e._v("删除\n                              ")])],1)],1)})],2)],1)}))]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"序号",type:"index"}}),e._v(" "),a("el-table-column",{attrs:{prop:"eventstep",label:"环节"}}),e._v(" "),a("el-table-column",{attrs:{prop:"eventname",label:"用户状态",width:"300"}}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态",formatter:e.formatStatus}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"260"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){e.addEvents(e.eventsTabIndex,"edit",t)}}},[e._v("编辑\n                    ")])]}}])})],1),e._v(" "),a("el-pagination",{attrs:{"current-page":1,"page-sizes":[10,20,30,40],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:e.eventsList.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1):a("div",{staticClass:"addEvents_ct"},[a("el-form",{ref:"addEventsFormRef"+s,refInFor:!0,attrs:{"label-position":"left","label-width":"100px",model:t.addEventsForm,rules:e.addEventsFormRules,size:"mini"}},[a("el-form-item",{attrs:{label:"环节：",prop:"eventstep"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(e){t.addEventsForm.eventtype=""}},model:{value:t.addEventsForm.eventstep,callback:function(a){e.$set(t.addEventsForm,"eventstep",a)},expression:"item.addEventsForm.eventstep"}},e._l(e.linkList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"用户状态：",prop:"eventtype"}},[a("el-select",{staticStyle:{width:"400px"},attrs:{autocomplete:"off",placeholder:"选择用户状态"},model:{value:t.addEventsForm.eventtype,callback:function(a){e.$set(t.addEventsForm,"eventtype",a)},expression:"item.addEventsForm.eventtype"}},e._l(e.selectLoanstep(t.addEventsForm.eventstep),function(e){return a("el-option",{key:e.eventtype,attrs:{label:e.eventname,value:e.eventtype}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"运营事件："}},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){e.addAllocation(s)}}},[e._v("新增时间配置\n                  ")])],1),e._v(" "),e._l(t.addEventsForm.messageEventsBeanList,function(n,l){return a("div",{key:l,staticClass:"event-item"},[a("div",{staticClass:"event-header"},[a("div",{staticClass:"event-header-left"},[e._v("\n                      配置"+e._s(l+1)+"\n                    ")]),e._v(" "),t.addEventsForm.messageEventsBeanList.length>1?a("div",{staticClass:"event-header-right"},[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(t){e.deleteAllocation(s,l)}}})],1):e._e()]),e._v(" "),a("div",{class:["event-contain",n.isError?"event-error":""]},[a("el-form-item",{attrs:{label:"配置时间段"}},[a("el-select",{attrs:{placeholder:"选择时间段"},model:{value:n.triggerday,callback:function(t){e.$set(n,"triggerday",t)},expression:"key.triggerday"}},e._l(e.timePart,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),a("el-select",{attrs:{placeholder:"选择开始时间"},model:{value:n.starttime,callback:function(t){e.$set(n,"starttime",t)},expression:"key.starttime"}},e._l(e.allTime,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),a("el-select",{attrs:{placeholder:"选择结束时间"},model:{value:n.endtime,callback:function(t){e.$set(n,"endtime",t)},expression:"key.endtime"}},e._l(e.allTime,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"发送时间"}},[a("el-select",{attrs:{placeholder:"选择发送时间"},model:{value:n.triggertime,callback:function(t){e.$set(n,"triggertime",t)},expression:"key.triggertime"}},e._l(e.allTime,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),n.isError?a("div",{staticClass:"el-form-item__error"},[e._v(e._s(n.errorText)+"\n                      ")]):e._e()],1),e._v(" "),e._l(n.messageEventsBeanList,function(t,i){return a("el-form-item",{key:i,staticClass:"event-setChannel",class:[t.isError?"event-error":""],attrs:{label:"配置渠道"}},[a("el-select",{attrs:{placeholder:"选择渠道"},on:{change:function(e){t.messageid="",t.content="",t.templateid=""}},model:{value:t.messagetype,callback:function(a){e.$set(t,"messagetype",a)},expression:"channel.messagetype"}},e._l(e.channelOption,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),a("el-input",{staticStyle:{width:"199.72px"},attrs:{placeholder:"渠道ID"},on:{blur:function(a){e.getSysEventDetailById(t.messageid,l,s,i)}},model:{value:t.messageid,callback:function(a){e.$set(t,"messageid",a)},expression:"channel.messageid"}}),e._v(" "),n.messageEventsBeanList.length>1?a("el-button",{staticStyle:{"margin-left":"15px"},attrs:{type:"danger",icon:"el-icon-minus",circle:""},on:{click:function(t){e.deleteBeanList(l,s,i)}}}):e._e(),e._v(" "),i==n.messageEventsBeanList.length-1?a("el-button",{attrs:{type:"primary",icon:"el-icon-plus",circle:""},on:{click:function(t){e.addBeanList(l,s)}}}):e._e(),e._v(" "),a("div",{staticClass:"event-content"},[e._v(e._s(t.content||t.templateid)+"\n                      ")]),e._v(" "),t.isError?a("div",{staticClass:"el-form-item__error"},[e._v("\n                        "+e._s(t.errorText)+"\n                      ")]):e._e()],1)})],2)])})],2),e._v(" "),a("el-footer",[a("el-button",{attrs:{plain:"",size:"medium"},on:{click:function(t){e.removeTab(e.eventsTabIndex)}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"medium",plain:""},on:{click:function(t){e.saveSysEvent(s,"addEventsFormRef"+s)}}},[e._v("确定\n                ")])],1)],1)])])}))],1)])],1)},staticRenderFns:[]};var d=a("VU/8")(u,c,!1,function(e){a("Oqub"),a("fhu2"),a("1rYy")},"data-v-70545b38",null);t.default=d.exports},Oqub:function(e,t){},fhu2:function(e,t){}});