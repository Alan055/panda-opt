webpackJsonp([18],{"6xQZ":function(t,e){},SY5z:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("woOf"),r=a.n(i),o=a("mvHQ"),s=a.n(o),l=a("fZjL"),n=a.n(l),d=a("G0J2"),u=(a("fMLZ"),{name:"HomeSuspension",data:function(){var t=this;return{BannerTypeList:[],allactiveName:"1001001",userStatus:"",allDialogListParams:{pageSize:10,pageNum:1},andDialogListParams:{pageSize:1,pageNum:10},iosDialogListParams:{pageSize:1,pageNum:10},actionWidth:!0,bigImgUrlDialog:!1,canDrag:!0,imgPercent:0,loaded:!1,loading:!0,bigImgUrl:"",content:"",addMaterialRules:{icontext:[{required:!0,message:"请输入文件名称"}],jumptype:[{required:!0,message:"请选择打开方式"}],jumplink:[{required:!0,message:"请填写跳转链接"}],starttime:[{required:!0,message:"请选择开始时间"},{validator:function(e,a,i){""===a?i(new Error("请输入开始时间")):(""!==t.addMaterialForm.endtime&&t.$refs.addMaterialForm.validateField("endtime"),i())},trigger:"change"}],endtime:[{required:!0,message:"请选择结束时间"},{validator:function(e,a,i){""===a?i(new Error("请输入结束时间")):a<t.addMaterialForm.starttime?i(new Error("结束时间不能小于开始时间!")):i()},trigger:"change"}]},pictureLimit:1,canEdit:!1,imageUrl:"",androidDialogList:[],iosDialogList:[],allDialogList:[],materialList:[],addMaterialListDialog:!1,addMaterialForm:{advertid:"",icontext:"",jumptype:"",jumplink:"",fileid:"",imgurl:""},defaultParams:{pageSize:10,pageNum:1},addPopupDialog:!1,addPopupForm:{oldIds:"",positionid:"",userstatus:"",starttime:"",devicetype:"",endtime:"",advertid:"",priority:"",frequency:"",advertList:[{advertid:"",jumplink:"",imgurl:""}]},addPopupFormRules:{icontext:[{required:!0,message:"请填写文件名称",trigger:"blur"}],jumptype:[{required:!0,message:"请选择跳转方式",trigger:"change"}],userstatus:[{required:!0,message:"请选择用户状态",trigger:"change"}],positionid:[{required:!0,message:"选择banner位置",trigger:"change"}]}}},components:{quillEditor:d.quillEditor},computed:{userStatusList:function(){return console.log(this.$store.state.userStatusList),this.$store.state.userStatusList},dialogMaterialList:function(){return console.log("1112333333333"),console.log(this.$store.state.bannerMaterialList.list),this.$store.state.bannerMaterialList},optionsOpen:function(){return this.$store.state.optionsOpen},optionDeviceType:function(){return this.$store.state.optionDeviceType},optionDefault:function(){return this.$store.state.optionDefault},actionUrl:function(){return this.$store.state.actionUrl},optionFrequency:function(){return this.$store.state.optionFrequency},dialogMaterialListAll:function(){return this.$store.state.bannerMaterialListAll},getAdvertImgurl:function(){return function(t){var e=this.$store.state.dialogMaterialListAll.list;if(e)for(var a=0;a<e.length;a++)if(e[a].advertid==t)return e[a].imgurl}},getAdvertJumplink:function(){return function(t){var e=this.$store.state.bannerMaterialListAll.list;if(e)for(var a=0;a<e.length;a++)if(e[a].advertid==t)return e[a].jumplink}}},methods:{handleStop:function(t,e){var a=this,i=1==e.status?"停用":"启用";this.$confirm("此操作将"+i+'悬浮窗 "'+e.icontext+'，" 是否继续?',"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){a.Api.maUpdateStatus({oldIds:e.relid,status:1==e.status?"0":"1",detailid:e.detailid||""}).then(function(t){200==t.data.code?(a.$message({type:"success",message:i+"成功!"}),a.getDialogList(e.devicetype)):a.$message.error(t.data.msg)})}).catch(function(){a.$message({type:"info",message:"已取消"+i})})},formatStatus:function(t,e){return 0==t.status?"已停用":"已启用"},init:function(){this.getDialogList("1"),this.getDialogList("2"),this.getBannerTypeList(),this.$store.dispatch("changeGetUserStatusList")},filterJumptype:function(t,e){switch(t.jumptype){case 1:return"内部打开h5链接";case 2:return"外部打开h5链接";case 3:return"仅展示不跳转"}},filterPosition:function(t,e){for(var a=0;a<this.BannerTypeList.length;a++)return console.log(this.BannerTypeList),t.positionid==this.BannerTypeList[a].positionId?this.BannerTypeList[a].desc:"无"},getBannerTypeList:function(){var t=this;this.Api.maGetAllBannerTypeList({}).then(function(e){200==e.data.code&&(t.BannerTypeList=e.data.data)})},formatJumptype:function(t,e){for(var a=0;a<this.optionsOpen.length;a++)if(t.jumptype==this.optionsOpen[a].value)return this.optionsOpen[a].label},formatDate:function(t,e){return t.starttime+" 至 "+t.endtime},onEditorChange:function(t){t.editor;var e=t.html;t.text;this.content=e},resetForm:function(t){this.$refs[t].resetFields()},closeDialog:function(){var t=this;this.resetForm("addMaterialForm"),n()(this.addMaterialForm).forEach(function(e){"dateTime"==e?t.addMaterialForm.dateTime=[]:(t.addMaterialForm[e]="",t.imageUrl="")})},closePopupDialog:function(){var t=this;this.resetForm("addPopupForm"),n()(this.addPopupForm).forEach(function(e){"dateTime"==e?t.addPopupForm.dateTime=[]:"advertList"==e?t.addPopupForm.advertList=[{advertid:"",jumplink:"",imgurl:""}]:t.addPopupForm[e]=""}),console.log(this.addPopupForm)},handleSizeChange:function(t){this.defaultParams.pageSize=t,this.$store.dispatch("changeBannerMaterialList",this.defaultParams)},handleCurrentChange:function(t){this.defaultParams.pageNum=t,this.$store.dispatch("changeBannerMaterialList",this.defaultParams)},getDialogList:function(t){var e=this;this.Api.maAdverList({positionId:"1001003",deviceType:t,pageSize:10,pageNum:1}).then(function(a){200==a.data.code?(e.loading=!1,1==t?e.allDialogList=a.data.data:e.iosDialogList=a.data.data):(e.loading=!1,e.$message.error(a.data.msg))})},addPopupDialogOpen:function(){this.addPopupDialog=!0},addMaterialList:function(t){this.addMaterialListDialog=!0},editMaterial:function(t,e){this.addMaterialListDialog=!0,this.addMaterialForm=JSON.parse(s()(e))},deletDetail:function(t){var e=this;this.$confirm('此操作将删除素材 "'+t.filename+'，" 是否继续?',"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){e.Api.maDelAdvert({advertId:t.advertid,detailId:t.detailid}).then(function(t){200==t.data.code?(e.$message({type:"success",message:"删除成功!"}),e.$store.dispatch("changeBannerMaterialList",e.defaultParams)):e.$message.error(t.data.msg)})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},sureSaveMaterial:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return!1;var a=String(new Date(e.addMaterialForm.starttime)),i=String(new Date(e.addMaterialForm.endtime)),r={positionid:1001003,icontext:e.addMaterialForm.icontext,devicetype:e.addMaterialForm.devicetype,jumptype:e.addMaterialForm.jumptype,jumplink:e.addMaterialForm.jumplink,fileid:e.addMaterialForm.fileid,relid:e.addMaterialForm.relid,detailid:e.addMaterialForm.detailid||"",starttime:a,endtime:i};e.addMaterialForm.advertid&&(r.advertid=e.addMaterialForm.advertid),e.Api.maSaveAdvert(r).then(function(t){200==t.data.code?(e.$message.success("保存成功"),e.getDialogList(e.addMaterialForm.devicetype),e.addMaterialListDialog=!1):e.$message.error(t.data.msg)})})},handleAvatarSuccess:function(t,e){var a=this;this.$message.success("上传成功"),this.imageUrl=URL.createObjectURL(e.raw);var i=new Image;i.src=this.imageUrl,i.onload=function(){a.addMaterialForm.imgmeasure=i.width+"*"+i.height,a.addMaterialForm.imgsize=(e.size/1024).toFixed(2)+"KB",a.addMaterialForm.imgurl=a.imageUrl,a.addMaterialForm.fileid=t.data.id,console.log(a.addMaterialForm.fileid)},this.loaded=!1},beforeAvatarUpload:function(t){var e="image/jpeg"===t.type||"image/png"===t.type||"image/gif"===t.type,a=t.size/1024/1024<1;return e?a?(this.loaded=!0,e&&a):(this.$message.error("上传图片大小不能超过1MB!"),void(this.loaded=!1)):(this.$message.error("上传启动图只能是PNG 格式!"),void(this.loaded=!1))},handleUploading:function(t,e,a){},changeMertial:function(t){console.log(t)},addMaterialItem:function(){this.addPopupForm.advertList&&4==this.addPopupForm.advertList.length?this.$message.error("最多添加4张素材"):this.addPopupForm.advertList.push({advertid:"",jumplink:"",imgurl:""})},removeMaterialItem:function(t){for(var e=0;e<this.addPopupForm.advertList.length;e++)e==t&&this.addPopupForm.advertList.splice(t,1)},upMaterialItem:function(t){console.log("index",t);var e=this.addPopupForm.advertList[t-1];this.$set(this.addPopupForm.advertList,t-1,this.addPopupForm.advertList[t]),this.$set(this.addPopupForm.advertList,t,e)},downMaterialItem:function(t){var e=this.addPopupForm.advertList[t+1];this.$set(this.addPopupForm.advertList,t+1,this.addPopupForm.advertList[t]),this.$set(this.addPopupForm.advertList,t,e)},sureSavePopup:function(t){for(var e=this,a=String(new Date(this.addPopupForm.starttime)),i=String(new Date(this.addPopupForm.endtime)),r=[],o=0;o<this.addPopupForm.advertList.length;o++)r=r.concat({advertid:this.addPopupForm.advertList[o].advertid,priority:o+1});this.$refs[t].validate(function(t){if(!t)return!1;var o={oldIds:e.addPopupForm.oldIds||"",positionid:e.addPopupForm.positionid,userstatus:e.addPopupForm.userstatus,starttime:a,endtime:i,materialInfoStr:s()(s()(r)),detailid:e.addPopupForm.detailid||""};console.log(o),e.addMaterialForm.advertid&&(o.advertid=e.addMaterialForm.advertid),e.Api.maSaveBannerAndIcon(o).then(function(t){200==t.data.code?(e.getDialogList(e.addPopupForm.devicetype),e.$message.success("保存成功"),e.addPopupDialog=!1):e.$message.error(t.data.msg)})})},checkAllStatus:function(t){console.log(t.name),this.getDialogList(t.name,this.userStatus)},editHomeDialog:function(t,e){console.log("===>row"),console.log(e),this.addPopupForm=r()(this.addPopupForm,e),this.addPopupDialog=!0},deletHomeDialog:function(t,e){var a=this;this.$confirm("此操作将永久删除弹窗 ，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error",center:!0}).then(function(){a.Api.maDelBannerAndIcon({oldIds:e.oldIds,detailId:item.detailid}).then(function(t){if(200==t.data.code)switch(a.$message({type:"success",message:"删除成功!"}),e.devicetype){case 0:a.getDialogList("0",a.allactiveName);break;case 1:a.getDialogList("1",a.andactiveName);break;case 2:a.getDialogList("2",a.iosactiveName)}})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})}},created:function(){this.init()},mounted:function(){},watch:{},filters:{jumpType:function(t){switch(t){case 1:return"内部打开h5链接";case 2:return"外部打开h5链接";case 3:return"仅展示不跳转"}}}}),m={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"supension-view"},[a("transition",{attrs:{name:"el-zoom-in-bottom"}},[a("div",{staticClass:"card-div"},[a("div",{staticClass:"plugins-tips"},[t._v("\n                为保障用户体验，首页弹窗图统一为PNG、jpg、gif格式，建议尺寸560*760，大小不超过1M。\n            ")]),t._v(" "),[a("div",[a("div",{staticClass:"figure-title"},[t._v("Android_悬浮窗")])]),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.allDialogList,border:"",stripe:""}},[a("el-table-column",{attrs:{prop:"icontext",label:"文件名称",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"jumplink",label:"跳转链接",width:"280"}}),t._v(" "),a("el-table-column",{attrs:{prop:"starttime",width:"300",label:"生效时间",formatter:t.formatDate}}),t._v(" "),a("el-table-column",{attrs:{label:"图片预览",width:"100",prop:"imgurl"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"left_imgContent"},[a("el-popover",{attrs:{placement:"right",title:"",trigger:"click"}},[a("img",{staticStyle:{"max-width":"700px","max-height":"700px"},attrs:{src:e.row.imgurl}}),t._v(" "),a("img",{staticStyle:{width:"80px",height:"80px"},attrs:{slot:"reference",src:e.row.imgurl,alt:e.row.imgurl},slot:"reference"})])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"status",formatter:t.formatStatus,label:"状态"}}),t._v(" "),a("el-table-column",{attrs:{prop:"updatetime",width:"160",label:"最近修改时间"}}),t._v(" "),a("el-table-column",{attrs:{prop:"username",label:"最后修改人"}}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){t.editMaterial(e.$index,e.row)}}},[t._v("编辑\n                            ")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"warning"},on:{click:function(a){t.handleStop(e.$index,e.row)}}},[t._v("\n                                "+t._s(1==e.row.status?"停用":"启用"))])]}}])})],1)],t._v(" "),[a("div",{staticStyle:{"margin-top":"20px"}},[a("div",{staticClass:"figure-title"},[t._v("IOS_悬浮窗")])]),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.iosDialogList,border:"",stripe:""}},[a("el-table-column",{attrs:{prop:"icontext",label:"文件名称",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"jumplink",label:"跳转链接",width:"280"}}),t._v(" "),a("el-table-column",{attrs:{prop:"starttime",width:"300",label:"生效时间",formatter:t.formatDate}}),t._v(" "),a("el-table-column",{attrs:{label:"图片预览",width:"100",prop:"imgurl"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"left_imgContent"},[a("el-popover",{attrs:{placement:"right",title:"",trigger:"click"}},[a("img",{staticStyle:{"max-width":"700px","max-height":"700px"},attrs:{src:e.row.imgurl}}),t._v(" "),a("img",{staticStyle:{width:"80px",height:"80px"},attrs:{slot:"reference",src:e.row.imgurl,alt:e.row.imgurl},slot:"reference"})])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"status",formatter:t.formatStatus,label:"状态"}}),t._v(" "),a("el-table-column",{attrs:{prop:"updatetime",width:"160",label:"最近修改时间"}}),t._v(" "),a("el-table-column",{attrs:{prop:"username",label:"最后修改人"}}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){t.editMaterial(e.$index,e.row)}}},[t._v("编辑\n                            ")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"warning"},on:{click:function(a){t.handleStop(e.$index,e.row)}}},[t._v("\n                                "+t._s(1==e.row.status?"停用":"启用"))])]}}])})],1)]],2)]),t._v(" "),a("el-dialog",{attrs:{title:"编辑悬浮窗",width:"40%",center:"",visible:t.addMaterialListDialog},on:{"update:visible":function(e){t.addMaterialListDialog=e},closed:t.closeDialog}},[a("div",{staticClass:"dialog-tips"},[a("i",{staticClass:"el-icon-info"}),t._v(" 为保障用户体验，悬浮窗图片统一为PNG、jpg、gif格式，大小不超过1M。")]),t._v(" "),a("el-form",{ref:"addMaterialForm",attrs:{model:t.addMaterialForm,rules:t.addMaterialRules,"label-width":"100px",size:"mini"}},[a("el-form-item",{attrs:{label:"文件名称",prop:"icontext"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.addMaterialForm.icontext,callback:function(e){t.$set(t.addMaterialForm,"icontext",e)},expression:"addMaterialForm.icontext"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"打开方式",prop:"jumptype"}},[a("el-select",{attrs:{placeholder:"请选择打开方式"},model:{value:t.addMaterialForm.jumptype,callback:function(e){t.$set(t.addMaterialForm,"jumptype",e)},expression:"addMaterialForm.jumptype"}},t._l(t.optionsOpen,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"开始时间",prop:"starttime"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime",placeholder:"选择开始时间"},model:{value:t.addMaterialForm.starttime,callback:function(e){t.$set(t.addMaterialForm,"starttime",e)},expression:"addMaterialForm.starttime"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"结束时间",prop:"endtime"}},[a("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择结束时间"},model:{value:t.addMaterialForm.endtime,callback:function(e){t.$set(t.addMaterialForm,"endtime",e)},expression:"addMaterialForm.endtime"}})],1),t._v(" "),1==t.addMaterialForm.jumptype||2==t.addMaterialForm.jumptype?a("el-form-item",{attrs:{label:"跳转链接",prop:"jumplink"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.addMaterialForm.jumplink,callback:function(e){t.$set(t.addMaterialForm,"jumplink",e)},expression:"addMaterialForm.jumplink"}})],1):t._e(),t._v(" "),a("el-form-item",{attrs:{label:"上传图片"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.actionUrl,drag:t.canDrag,disabled:t.loaded,"with-credentials":t.actionWidth,"show-file-list":!1,"on-progress":t.handleUploading,"on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload}},[t.addMaterialForm.imgurl?a("img",{staticClass:"avatar",attrs:{src:t.addMaterialForm.imgurl||""}}):t._e(),t._v(" "),a("i",{staticClass:"el-icon-upload"}),t._v(" "),t.loaded?a("div",{staticClass:"el-up-loading"},[a("i",{staticClass:"el-icon-loading"}),a("br"),t._v("拼命上传中")]):t._e(),t._v(" "),a("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),a("em",[t._v("点击上传")])]),t._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传jpg/png文件，且不超过1MB")])])],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.addMaterialListDialog=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.sureSaveMaterial("addMaterialForm")}}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var c=a("VU/8")(u,m,!1,function(t){a("6xQZ"),a("tkJF")},"data-v-3c1b8a52",null);e.default=c.exports},tkJF:function(t,e){}});