webpackJsonp([35],{"2eVM":function(e,n){},ec4i:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=t("fZjL"),l=t.n(a),i=t("woOf"),o=t.n(i),r=t("mvHQ"),s=t.n(r),d={name:"BlockChannels",data:function(){return{searchForm:{channelid:"",model:""},defaultParams:{pageSize:10,pageNumber:1},addChannelList:[{channelname:"",channelid:"",model:"",remark:""}],channelList:[],addChannelDialog:!1,addChannelForm:{telTitle:""},addChannelFormRules:{},editChannelDialog:!1,editChannelForm:{id:"",channelid:"",channelname:"",model:""},editChannelRules:{model:[{required:!0,message:"请选择屏蔽模块",trigger:"change"}]},optionSearchShielding:[{value:"0",label:"全部"},{value:"1",label:"贷超"},{value:"2",label:"贷超信用卡"}]}},computed:{optionShielding:function(){return this.$store.state.optionShielding},optionChannelId:function(){return this.$store.state.optionChannelId}},methods:{init:function(){this.getLoanmarketListById()},closeAddChannel:function(){this.addChannelList=[{channelname:"",channelid:"",model:"",remark:"",err:!1}]},formatModel:function(e,n){switch(e.model){case"1":return"贷超";case"2":return"贷超信用卡"}},getLoanmarketListById:function(){var e=this;this.Api.loGetLoanmarketListById({channelname:this.searchForm.channelname||"",model:"0"==this.searchForm.model?"":this.searchForm.model||"",pageSize:this.defaultParams.pageSize,pageNumber:this.defaultParams.pageNumber}).then(function(n){200==n.data.code&&(e.channelList=n.data.data)})},handleAdd:function(e,n){console.log(e),console.log(this.addChannelList.length),this.addChannelList.push({channelname:"",channelid:"",model:"",remark:"",err:!1})},handleMinus:function(e,n){for(var t=0;t<this.addChannelList.length;t++)t==e&&this.addChannelList.splice(e,1)},searchChannel:function(){this.defaultParams.pageNumber=1,this.getLoanmarketListById()},handleCurrentChange:function(e){this.defaultParams.pageNumber=e,this.getLoanmarketListById()},handleSizeChange:function(e){this.defaultParams.pageSize=e,this.getLoanmarketListById()},deleteChannel:function(e){var n=this;this.$confirm('此操作将永久删除渠道 "'+e.channelname+'" 是否继续?',"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error",center:!0}).then(function(){n.Api.loDeleteLoanmarketByIdl({channelid:e.channelid,id:e.id}).then(function(e){200==e.data.code?(n.$message({type:"success",message:"删除成功!"}),n.getLoanmarketListById()):n.$message({type:"error",message:e.data.msg})})}).catch(function(){n.$message({type:"info",message:"已取消删除"})})},addChannel:function(){this.addChannelDialog=!0},tableRowClassName:function(e){var n=e.row;e.rowIndex;return 1==n.err?"warning-row":""},sureSaveChannel:function(){var e=this;console.log(this.addChannelList);for(var n=0,t=0;t<this.addChannelList.length;t++)this.addChannelList[t].channelname&&this.addChannelList[t].channelid&&this.addChannelList[t].model?(this.addChannelList[t].err=!1,n++):this.addChannelList[t].err=!0;n==this.addChannelList.length?this.Api.loSureSaveChannel({data:s()(s()(this.addChannelList))}).then(function(n){200==n.data.code?(e.$message.success("保存成功"),e.addChannelDialog=!1,e.getLoanmarketListById()):e.$message.error(n.data.msg)}):this.$message.error("请填写完整信息")},editChannel:function(e){this.editChannelForm=o()(this.editChannelForm,e),this.editChannelDialog=!0},closeDialog:function(){var e=this;l()(this.editChannelForm).forEach(function(n){e.editChannelForm[n]=""})},sureSaveEditChannel:function(e){var n=this;this.$refs[e].validate(function(e){if(!e)return!1;n.Api.loSaveLoanmarketList({id:n.editChannelForm.id,model:n.editChannelForm.model,channelid:n.editChannelForm.channelid}).then(function(e){200==e.data.code?(n.$message.success("保存成功"),n.getLoanmarketListById(),n.editChannelDialog=!1):n.$message.error(e.data.msg)})})}},created:function(){this.init()}},c={render:function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"blockChannels-view"},[t("div",{staticClass:"container"},[t("div",{staticClass:"plugins-tips"},[t("div",{staticClass:"plugins-search"},[t("el-form",[t("el-row",{attrs:{gutter:40}},[t("el-col",{attrs:{span:10}},[t("el-form-item",{attrs:{label:"渠道名",labelWidth:"60px"}},[t("el-input",{attrs:{placeholder:"请输入渠道名"},model:{value:e.searchForm.channelname,callback:function(n){e.$set(e.searchForm,"channelname",n)},expression:"searchForm.channelname"}})],1)],1),e._v(" "),t("el-col",{attrs:{span:10}},[t("el-form-item",{attrs:{label:"屏蔽模块",labelWidth:"80px"}},[t("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.searchForm.model,callback:function(n){e.$set(e.searchForm,"model",n)},expression:"searchForm.model"}},e._l(e.optionSearchShielding,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1),e._v(" "),t("el-col",{attrs:{span:4}},[t("el-form-item",{attrs:{label:"",labelWidth:"1px"}},[t("el-button",{attrs:{type:"primary",plain:""},on:{click:e.searchChannel}},[e._v("搜索")])],1)],1)],1)],1)],1),e._v(" "),t("div",{staticClass:"add-btn",on:{click:e.addChannel}},[t("i",{staticClass:"el-icon-lx-roundadd"}),e._v("新增渠道\n            ")])]),e._v(" "),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.channelList.list,border:""}},[t("el-table-column",{attrs:{label:"序号",type:"index"}}),e._v(" "),t("el-table-column",{attrs:{prop:"createtime",label:"屏蔽执行时间",width:"150"}}),e._v(" "),t("el-table-column",{attrs:{prop:"channelname",label:"渠道名",width:"120"}}),e._v(" "),t("el-table-column",{attrs:{prop:"channelid",label:"渠道号",width:"120"}}),e._v(" "),t("el-table-column",{attrs:{prop:"model",label:"屏蔽模块",formatter:e.formatModel}}),e._v(" "),t("el-table-column",{attrs:{prop:"remark",label:"备注"}}),e._v(" "),t("el-table-column",{attrs:{prop:"updatetime",label:"最后修改时间"}}),e._v(" "),t("el-table-column",{attrs:{prop:"updateby",label:"最后修改人"}}),e._v(" "),t("el-table-column",{attrs:{fixed:"right",label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.editChannel(n.row)}}},[e._v("编辑")]),e._v(" "),t("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(t){e.deleteChannel(n.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),t("el-pagination",{attrs:{"current-page":e.defaultParams.pageNumber,"page-sizes":[10,20,30,40],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:e.channelList.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),t("el-dialog",{staticClass:"addChannelDialog",attrs:{title:"新增屏蔽商业渠道",width:"40%",center:"",visible:e.addChannelDialog},on:{"update:visible":function(n){e.addChannelDialog=n},closed:e.closeAddChannel}},[t("el-row",{attrs:{gutter:40}},[t("el-form",[t("el-table",{staticStyle:{width:"100%"},attrs:{"row-class-name":e.tableRowClassName,data:e.addChannelList}},[t("el-table-column",{attrs:{prop:"channelId",label:"渠道号",width:"100"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-form-item",[t("el-input",{attrs:{placeholder:"渠道号"},model:{value:n.row.channelid,callback:function(t){e.$set(n.row,"channelid",t)},expression:"scope.row.channelid"}})],1)]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"channelName",label:"渠道名",width:"100"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-form-item",[t("el-input",{attrs:{placeholder:"渠道名"},model:{value:n.row.channelname,callback:function(t){e.$set(n.row,"channelname",t)},expression:"scope.row.channelname"}})],1)]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"shielding",label:"屏蔽模块"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-form-item",[t("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:n.row.model,callback:function(t){e.$set(n.row,"model",t)},expression:"scope.row.model"}},e._l(e.optionShielding,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"mark",label:"备注"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-form-item",[t("el-input",{attrs:{placeholder:"备注"},model:{value:n.row.remark,callback:function(t){e.$set(n.row,"remark",t)},expression:"scope.row.remark"}})],1)]}}])}),e._v(" "),t("el-table-column",{attrs:{label:""},scopedSlots:e._u([{key:"default",fn:function(n){return[n.$index==e.addChannelList.length-1?t("el-button",{attrs:{size:"mini",icon:"el-icon-plus"},on:{click:function(t){e.handleAdd(n.$index,n.row)}}}):e._e(),e._v(" "),e.addChannelList.length>1?t("el-button",{attrs:{size:"mini",icon:"el-icon-minus"},on:{click:function(t){e.handleMinus(n.$index,n.row)}}}):e._e()]}}])})],1)],1)],1),e._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(n){e.addChannelDialog=!1}}},[e._v("取消")]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:function(n){e.sureSaveChannel("addChannelForm")}}},[e._v("确 定")])],1)],1),e._v(" "),t("el-dialog",{attrs:{title:"编辑屏蔽商业渠道",width:"40%",center:"",visible:e.editChannelDialog},on:{"update:visible":function(n){e.editChannelDialog=n},closed:e.closeDialog}},[t("el-form",{ref:"editChannelForm",attrs:{model:e.editChannelForm,rules:e.editChannelRules,"label-width":"100px",size:"mini"}},[t("el-form-item",{attrs:{label:"渠道号"}},[t("el-input",{attrs:{readOnly:""},model:{value:e.editChannelForm.channelid,callback:function(n){e.$set(e.editChannelForm,"channelid",n)},expression:"editChannelForm.channelid"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"渠道名"}},[t("el-input",{attrs:{readOnly:""},model:{value:e.editChannelForm.channelname,callback:function(n){e.$set(e.editChannelForm,"channelname",n)},expression:"editChannelForm.channelname"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"屏蔽模块",prop:"model"}},[t("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.editChannelForm.model,callback:function(n){e.$set(e.editChannelForm,"model",n)},expression:"editChannelForm.model"}},e._l(e.optionShielding,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1),e._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(n){e.editChannelDialog=!1}}},[e._v("取消")]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:function(n){e.sureSaveEditChannel("editChannelForm")}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var h=t("VU/8")(d,c,!1,function(e){t("2eVM")},null,null);n.default=h.exports}});