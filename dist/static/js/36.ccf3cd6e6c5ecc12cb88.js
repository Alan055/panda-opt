webpackJsonp([36],{"3S4z":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("woOf"),i=a.n(n),o=a("T0gc"),l=a("KvOm"),s=a("7MUq"),r=(a("3f40"),a("4qOc"),a("+cgv"),a("G0J2")),c=[["bold","italic","underline","strike"],["blockquote","code-block"],["formula"],["clean"],["link","image","video"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}]],d={components:{myTable:o.a,quillEditor:r.quillEditor},mixins:[l.c],data:function(){return{tableData:[{}],showModal:!1,Modal_isNew:!0,modalData:{},modalDataRule:{name:[{required:!0,message:"请输入公告名称",trigger:"change"},{max:10,message:"最多输入10个字符",trigger:"change"}],content:[{required:!0,message:"请输入公告内容",trigger:"change"}],location:[{required:!0,message:"请选择展示位置",trigger:"change"}]},selectData:[{label:"首页",value:"1"},{label:"媒体报道",value:"2"},{label:"全局",value:"3"}],actionWidth:!0,editorOption:{placeholder:"请输入公告内容",modules:{toolbar:{container:c,handlers:{image:function(e){e?document.querySelector("#iviewUp input").click():this.quill.format("image",!1)}}}}}}},computed:{actionUrl:function(){return this.$store.state.actionUrl}},watch:{},methods:{deleteRow:function(e){var t=this;this.$confirm("确定要删除此条记录吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){t.Api.loDeleteLinkListById({advertid:e}).then(function(e){var a=e.data;200===a.code?(t.$message({type:"success",message:"删除成功！"}),t.init()):t.$message({type:"error",message:a.msg})}).catch(function(e){t.$message({type:"error",message:e})})}).catch(function(){t.$message({type:"info",message:"已取消删除！"})})},online_offline:function(){var e=this;this.$confirm("确定上线吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){e.Api.loDeleteLinkListById({advertid:id}).then(function(t){var a=t.data;200===a.code?(e.$message({type:"success",message:"删除成功！"}),e.init()):e.$message({type:"error",message:a.msg})}).catch(function(t){e.$message({type:"error",message:t})})}).catch(function(){e.$message({type:"info",message:"已取消删除！"})})},openModal:function(e){this.Modal_isNew=void 0==e,this.modalData=e||{name:"",content:"",location:""},this.showModal=!0},handleAvatarSuccess:function(e,t){var a=this.$refs.myQuillEditor_announcement[0].quill;if("200"==e.code){var n=a.getSelection().index;a.insertEmbed(n,"image",e.data.url),a.setSelection(n+1)}else this.$message.error("图片插入失败")},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type||"image/png"===e.type||"image/gif"===e.type;if(t)return t;this.$message.error("请选择png/jpg/gif 格式图片!")},submit:s.a.throttle(function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;var a=localStorage.getItem("ms_username"),n={updateby:a,productid:localStorage.getItem("productId")};!t.currentAddData.advertid&&(n.createby=a),t.currentAddData.jumplink=t.myUrl+"#/scan/"+t.currentAddData.advertid+"/"+t.currentAddData.title,t.Api.loSaveContractLinkListById(i()({materialtype:4},t.currentAddData,n)).then(function(e){var a=e.data;200===a.code?(t.$message({type:"success",message:t.currentAddData.advertid?"编辑成功！":"添加成功！"}),t.removeTab(t.editableTabsValue)):t.$message({type:"error",message:a.msg})}).catch(function(e){t.$message({type:"error",message:e})})})}),init:function(){}},created:function(){this.init()},mounted:function(){}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"AnnouncementManagement_view"},[a("div",{staticClass:"newAdd"},[a("span",{staticClass:"add-btn",on:{click:function(t){e.openModal()}}},[a("i",{staticClass:"el-icon-lx-roundadd"}),e._v("新增公告\n    ")])]),e._v(" "),a("div",{staticClass:"container"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.exportLoading,expression:"exportLoading"}]},[a("myTable",{attrs:{tableData:e.tableData,pagination:e.pagination,ajax:e.init},on:{"update:pagination":function(t){e.pagination=t}}},[a("el-table-column",{attrs:{fixed:"",prop:"index",label:"序号",type:"index",index:e.indexMethod}}),e._v(" "),a("el-table-column",{attrs:{fixed:"",prop:"title",label:"公告名称"}}),e._v(" "),a("el-table-column",{attrs:{fixed:"",prop:"imgurl",label:"展示"}}),e._v(" "),a("el-table-column",{attrs:{fixed:"",prop:"updatetime",label:"最近修改时间"}}),e._v(" "),a("el-table-column",{attrs:{fixed:"",prop:"updateby",label:"最后修改人"}}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"220",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){e.openModal(t.row)}}},[e._v("编辑\n            ")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){e.deleteRow(t.row.advertid)}}},[e._v("删除")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(a){e.online_offline(t.row)}}},[e._v("上线")])]}}])})],1)],1)]),e._v(" "),a("el-dialog",{attrs:{title:(e.Modal_isNew?"新增":"编辑")+"公告内容",visible:e.showModal,width:"60%",center:""},on:{"update:visible":function(t){e.showModal=t}}},[a("div",[a("el-form",{ref:"modalData",staticClass:"formTop1",attrs:{inline:!0,"label-position":"left","label-width":"100px",align:"center",model:e.modalData,rules:e.modalDataRule}},[a("el-form-item",{attrs:{label:"公告名称：",prop:"name"}},[a("el-input",{staticClass:"input-with-select",staticStyle:{width:"215px"},attrs:{placeholder:"请输入公告名称"},model:{value:e.modalData.name,callback:function(t){e.$set(e.modalData,"name",t)},expression:"modalData.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"公告内容：",prop:"content"}},[a("el-upload",{staticClass:"avatar-uploader",staticStyle:{display:"none"},attrs:{id:"iviewUp",action:e.actionUrl,"with-credentials":e.actionWidth,"show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[a("i",{staticClass:"el-icon-upload"})]),e._v(" "),a("quill-editor",{ref:"myQuillEditor_announcement",attrs:{options:e.editorOption},model:{value:e.modalData.content,callback:function(t){e.$set(e.modalData,"content",t)},expression:"modalData.content"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"展示位置：",prop:"location"}},[a("el-select",{attrs:{placeholder:"请选择展示位置"},model:{value:e.modalData.location,callback:function(t){e.$set(e.modalData,"location",t)},expression:"modalData.location"}},e._l(e.selectData,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.showModal=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submit("modalData")}}},[e._v("确 定")])],1)])],1)},staticRenderFns:[]};var m=a("VU/8")(d,u,!1,function(e){a("e9e5")},null,null);t.default=m.exports},e9e5:function(e,t){}});