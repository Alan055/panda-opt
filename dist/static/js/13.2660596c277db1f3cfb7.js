webpackJsonp([13],{MojJ:function(e,t){},NiBL:function(e,t){},hP3r:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("vjgg"),n={name:"SmgAudit",data:function(){return{dialogTableVisible:!1,changeRecordList:[],loaded:!1,actionWidth:!0,loading1:!1,loading2:!1,fileNumber:1,fileList:[],userNumber:"0",objectOption:[{label:"用户包",value:"1"},{label:"指定用户",value:"2"}],pageNumber1:1,pageSize1:10,pageNumber2:1,pageSize2:10,listPushObjectOption:[{label:"全部",value:"0"},{label:"手机号码",value:"1"},{label:"文件",value:"2"}],statusOption:[{label:"待审核",value:1},{label:"已审核",value:0}],checkStatus:3,queryMassMessageMassList:[],waitAuditList:[],approvedList:[],listPushObject:"0",searchList1:"",searchList2:"",isIndeterminate1:!1,isIndeterminate2:!1,checkedTables1:[],checkedTables2:[],checkAll1:!0,checkAll2:!0,tableOptions1:[{label:"序号",prop:"",type:"index"},{label:"申请时间",prop:"createTime",type:"time"},{label:"群发时间",prop:"expectTime",type:"time"},{label:"申请人",prop:"creator",type:"normal"},{label:"类型",prop:"type",type:"filter",formatters:this.filterSendType},{label:"群发对象",prop:"sendType",type:"filter",formatters:this.filterObj},{label:"群发数量",prop:"sendTotal",type:"normal"},{label:"音频ID",prop:"templeteId",type:"content"},{label:"备注",prop:"title",type:"content"},{label:"状态",prop:"status",type:"filter",formatters:this.filterStatus}],tableOptions2:[{label:"序号",prop:"",type:"index"},{label:"申请时间",prop:"createTime",type:"time"},{label:"群发时间",prop:"expectTime",type:"time"},{label:"申请人",prop:"creator",type:"normal"},{label:"类型",prop:"type",type:"filter",formatters:this.filterSendType},{label:"群发对象",prop:"sendType",type:"filter",formatters:this.filterObj},{label:"群发数量",prop:"sendTotal",type:"normal"},{label:"音频ID",prop:"templeteId",type:"content"},{label:"备注",prop:"title",type:"content"}]}},computed:{saveUrl:function(){return this.$store.state.saveUrl+"?type=0"},canUpload:function(){return this.fileList.length>0},optionJumpType:function(){return this.$store.state.optionJumpType},codeLength:function(){for(var e=0,t=this.addPushForm.content,a=0;a<t.length;a++){var s=t.charCodeAt(a);e+=s>=0&&s<=255||s>=65377&&s<=65439?1:2}return e>=200&&(this.addPushForm.content=t.substr(0,e)),e},widthTh:function(){return function(e){return"content"==e?"300":"time"==e?"150":""}}},methods:{sendApply:function(){},testApply:function(){},addPopupDialogOpen:function(){},handleCurrentChange1:function(e){this.pageNumber1=e,this.getQueryMassMessageMassLi(2)},handleSizeChange1:function(e){this.pageSize1=e,this.getQueryMassMessageMassLi(2)},handleCurrentChange2:function(e){this.pageNumber2=e,this.getQueryMassMessageMassLi(1)},handleSizeChange2:function(e){this.pageSize2=e,this.getQueryMassMessageMassLi(1)},keyWordSearch1:function(){this.pageSize1=10,this.pageNumber1=1,this.getQueryMassMessageMassLi(2)},keyWordSearch2:function(){this.pageSize2=10,this.pageNumber2=1,this.getQueryMassMessageMassLi(1)},getQueryMassMessageMassLi:function(e){var t=this,a={messagetype:4,status:e||"",sendType:this.listPushObject,keyword:this.searchList};2==e?(this.loading1=!0,a.keyword=this.searchList1,a.pageSize=this.pageSize1,a.pageNumber=this.pageNumber1):(this.loading2=!0,a.keyword=this.searchList2,a.pageSize=this.pageSize2,a.pageNumber=this.pageNumber2),s.a.sentQueryMassMessageMassList(a).then(function(a){console.log(a),200==a.data.code?2==e?t.waitAuditList=a.data.data:1==e&&(t.approvedList=a.data.data):t.$message({type:"error",message:a.data.msg}),2==e?t.loading1=!1:1==e&&(t.loading2=!1)}).catch(function(a){2==e?t.loading1=!1:1==e&&(t.loading2=!1)})},getSysEventDetailById:function(){var e=this;this.addPushForm.content="",this.addPushForm.jumpType="",this.addPushForm.jumpLink="",this.addPushForm.pushId&&this.addPushForm.pushId.length>=18&&this.Api.msGetSysEventDetailById({id:this.addPushForm.pushId}).then(function(t){200==t.data.code?t.data.data?"4"==t.data.data.messagetype?(e.addPushForm.content=t.data.data.content,e.addPushForm.jumpType=t.data.data.jumpinner||0,e.addPushForm.jumpLink=t.data.data.gotourl||""):e.$message.error("请输入Push类型的id"):e.$message.error("渠道id不正确或者消息类型不匹配"):(e.addPushForm.content="",e.$message.error(t.data.msg))})},changeThrough:function(e,t){var a=this;this.$confirm("是否确认通过此群发？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){var e=new Date(Date.parse(t.expectTime.replace(/-/g,"/")));new Date>e?a.$confirm("当前时间已过群发时间，是否确认审核通过","提示",{confirmButtonText:"通过",cancelButtonText:"作废",type:"warning",center:!0}).then(function(){a.apiThrough(t.id,2)}).catch(function(){a.apiThrough(t.id,7)}):a.apiThrough(t.id,2)}).catch(function(){a.$message({type:"info",message:"已取消审核"})})},apiThrough:function(e,t){var a=this;s.a.auUpdateAuditStatusById({messagetype:4,status:2,id:e}).then(function(e){200==e.data.code?(a.$message({type:"success",message:"操作成功!"}),a.getQueryMassMessageMassLi(2),a.getQueryMassMessageMassLi(1)):a.$message({type:"error",message:e.data.msg})}).catch(function(e){a.$message({type:"error",message:e.msg})})},changeRefused:function(e,t){var a=this;this.$prompt("请输入拒绝原因","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"拒绝原因不能为空",inputPlaceholder:"请输入拒绝原因",type:"warning",center:!0,inputType:"textarea"}).then(function(e){var n=e.value;s.a.auUpdateAuditStatusById({messagetype:4,status:1,id:t.id,remark:n}).then(function(e){200==e.data.code?(a.$message({type:"success",message:"操作成功!"}),a.getQueryMassMessageMassLi(2),a.getQueryMassMessageMassLi(1)):a.$message({type:"error",message:e.data.msg})}).catch(function(e){a.$message({type:"error",message:e.msg})})}).catch(function(){a.$message({type:"info",message:"已取消审核"})})},sentTest:function(e,t){var a=this;this.$prompt("请输入测试手机号码","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0,inputPattern:/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$/,inputErrorMessage:"请输入正确的手机号码"}).then(function(e){var n=e.value;s.a.auSendAutotelTest({mobile:n,messageid:t.templeteId}).then(function(e){200==e.data.code?a.$message({type:"success",message:"发送成功"}):a.$message({type:"error",message:e.data.msg})}).catch(function(e){a.$message({type:"error",message:e.msg})})}).catch(function(){a.$message({type:"info",message:"取消测试"})})},handleCheckAllChange1:function(e){this.checkedTables1=e?this.tableOptions1:[],this.isIndeterminate1=!1},handleCheckedChange1:function(e){console.log(e);var t=e.length;this.checkAll1=t===this.tableOptions1.length,this.isIndeterminate1=t>0&&t<this.tableOptions1.length},handleCheckAllChange2:function(e){this.checkedTables2=e?this.tableOptions2:[],this.isIndeterminate2=!1},handleCheckedChange2:function(e){console.log(e);var t=e.length;this.checkAll2=t===this.tableOptions2.length,this.isIndeterminate2=t>0&&t<this.tableOptions2.length},filterJumptype:function(e,t){switch(e.jumptype){case 1:return"内部打开h5链接";case 2:return"外部打开h5链接";case 3:return"仅展示不跳转"}},filterStatus:function(e,t){switch(e.status){case 0:return"待审核";case 1:return"审核拒绝";case 2:return"审核通过";case 3:return"准备生成记录";case 4:return"待发送";case 5:return"已发送";case 6:return"发送失败";case 7:return"已过期"}},filterObj:function(e,t){switch(e.sendType){case 1:return"用户包";case 2:return"指定用户"}},filterType:function(e,t){switch(e.type){case 1:return"新增";case 2:return"审核通过";case 3:return"审核拒绝"}},filterSendType:function(e,t){switch(e.type){case 1:return"营销";case 2:return"通知";case 3:return"手机号码包"}}},created:function(){var e=this;this.approvedList.total=0,this.waitAuditList.total=0,this.$nextTick(function(){e.getQueryMassMessageMassLi(2),e.getQueryMassMessageMassLi(1)})}},i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"pushGroup"},[a("transition",{attrs:{name:"el-zoom-in-bottom"}},[a("div",[a("el-tabs",{attrs:{type:"border-card"}},[a("el-tab-pane",{attrs:{label:"待审核("+e.waitAuditList.total+")"}},[a("div",{staticClass:"plugins-tips"},[a("el-form",{attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"搜索："}},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入内容"},model:{value:e.searchList1,callback:function(t){e.searchList1=t},expression:"searchList1"}},[a("el-button",{attrs:{slot:"append",type:"primary"},on:{click:e.keyWordSearch1},slot:"append"},[e._v("搜索")])],1)],1)],1),e._v(" "),a("el-form",{attrs:{inline:!1}},[a("el-form-item",{attrs:{label:"选择表格显示项"}},[a("el-checkbox",{attrs:{indeterminate:e.isIndeterminate1},on:{change:e.handleCheckAllChange1},model:{value:e.checkAll1,callback:function(t){e.checkAll1=t},expression:"checkAll1"}},[e._v("\n                  全选\n                ")]),e._v(" "),a("div",{staticStyle:{margin:"15px 0"}}),e._v(" "),a("el-checkbox-group",{on:{change:e.handleCheckedChange1},model:{value:e.checkedTables1,callback:function(t){e.checkedTables1=t},expression:"checkedTables1"}},e._l(e.tableOptions1,function(t,s){return a("el-checkbox",{key:s,attrs:{checked:"",label:t}},[e._v("\n                    "+e._s(t.label)+"\n                  ")])}))],1)],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading1,expression:"loading1"}],staticStyle:{width:"100%"},attrs:{stripe:"",data:e.waitAuditList.list||[],border:""}},[e._l(e.checkedTables1,function(t){return["popover"==t.type?a("el-table-column",{key:t.label,attrs:{prop:t.prop,label:t.label,type:"index"==t.type?"index":"",width:e.widthTh(t.type),formatter:t.formatters},scopedSlots:e._u([{key:"default",fn:function(s){return[a("el-popover",{attrs:{placement:"top-start",trigger:"click",content:s.row.url}},[a("el-button",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(t.popoverTitle))])],1)]}}])}):a("el-table-column",{key:t.label,attrs:{prop:t.prop,label:t.label,type:"index"==t.type?"index":"",width:e.widthTh(t.type),formatter:t.formatters}})]}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"240",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){e.sentTest(t.$index,t.row)}}},[e._v("测试\n                ")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(a){e.changeThrough(t.$index,t.row)}}},[e._v("通过\n                ")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"warning"},on:{click:function(a){e.changeRefused(t.$index,t.row)}}},[e._v("拒绝\n                ")])]}}])})],2),e._v(" "),a("el-pagination",{attrs:{"current-page":e.pageNumber1,"page-size":e.pageSize1,"page-sizes":[10,20,30,40],layout:"total, sizes, prev, pager, next, jumper",total:e.waitAuditList.total},on:{"size-change":e.handleSizeChange1,"current-change":e.handleCurrentChange1}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"已审核("+e.approvedList.total+")"}},[a("div",{staticClass:"plugins-tips"},[a("el-form",{attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"搜索："}},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入内容"},model:{value:e.searchList2,callback:function(t){e.searchList2=t},expression:"searchList2"}},[a("el-button",{attrs:{slot:"append",type:"primary"},on:{click:e.keyWordSearch2},slot:"append"},[e._v("搜索")])],1)],1)],1),e._v(" "),a("el-form",{attrs:{inline:!1}},[a("el-form-item",{attrs:{label:"选择表格显示项"}},[a("el-checkbox",{attrs:{indeterminate:e.isIndeterminate2},on:{change:e.handleCheckAllChange2},model:{value:e.checkAll2,callback:function(t){e.checkAll2=t},expression:"checkAll2"}},[e._v("\n                  全选\n                ")]),e._v(" "),a("div",{staticStyle:{margin:"15px 0"}}),e._v(" "),a("el-checkbox-group",{on:{change:e.handleCheckedChange2},model:{value:e.checkedTables2,callback:function(t){e.checkedTables2=t},expression:"checkedTables2"}},e._l(e.tableOptions2,function(t,s){return a("el-checkbox",{key:s,attrs:{checked:"",label:t}},[e._v("\n                    "+e._s(t.label)+"\n                  ")])}))],1)],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading2,expression:"loading2"}],staticStyle:{width:"100%"},attrs:{stripe:"",data:e.approvedList.list||[],border:""}},[e._l(e.checkedTables2,function(t){return["popover"==t.type?a("el-table-column",{key:t.label,attrs:{prop:t.prop,label:t.label,type:"index"==t.type?"index":"",width:e.widthTh(t.type),formatter:t.formatters},scopedSlots:e._u([{key:"default",fn:function(s){return[a("el-popover",{attrs:{placement:"top-start",trigger:"click",content:s.row.url}},[a("el-button",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(t.popoverTitle))])],1)]}}])}):a("el-table-column",{key:t.label,attrs:{prop:t.prop,label:t.label,type:"index"==t.type?"index":"",width:e.widthTh(t.type),formatter:t.formatters}})]}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"140",fixed:"right",prop:"status"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.status?a("el-popover",{attrs:{placement:"left-start",width:"220",trigger:"click",content:t.row.remark}},[a("el-button",{staticStyle:{color:"#f56c6c"},attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v("审核未通过,查看原因")])],1):a("el-button",{staticStyle:{color:"#67C23A"},attrs:{size:"mini",type:"text"}},[e._v("审核通过\n                ")])]}}])})],2),e._v(" "),a("el-pagination",{attrs:{"current-page":e.pageNumber2,"page-sizes":[10,20,30,40],"page-size":e.pageSize2,layout:"total, sizes, prev, pager, next, jumper",total:e.approvedList.total},on:{"size-change":e.handleSizeChange2,"current-change":e.handleCurrentChange2}})],1)],1)],1)])],1)},staticRenderFns:[]};var r=a("VU/8")(n,i,!1,function(e){a("MojJ"),a("NiBL")},"data-v-bcfec6b2",null);t.default=r.exports}});