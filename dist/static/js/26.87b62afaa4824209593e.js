webpackJsonp([26],{Ycec:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a("fZjL"),n=a.n(l),o=a("woOf"),i=a.n(o),r=a("mvHQ"),s=a.n(r),d={name:"BlockUsers",data:function(){return{searchForm:{mobile:"",model:""},defaultParams:{pageSize:10,pageNumber:1},addChannelList:[{mobile:"",model:"",remark:""}],channelList:[],addChannelDialog:!1,addChannelForm:{telTitle:""},addChannelFormRules:{},editChannelDialog:!1,editChannelForm:{id:"",remark:"",mobile:"",model:""},editChannelRules:{model:[{required:!0,message:"请选择屏蔽模块",trigger:"change"}]},optionSearchShielding:[{value:"0",label:"全部"},{value:"1",label:"贷超"},{value:"2",label:"贷超信用卡"}]}},computed:{optionShielding:function(){return this.$store.state.optionShielding},optionChannelId:function(){return this.$store.state.optionChannelId}},methods:{init:function(){this.getLoanmarketListById()},closeAddChannel:function(){this.addChannelList=[{mobile:"",model:"",remark:"",err:!1}]},formatModel:function(e,t){switch(e.model){case"1":return"贷超";case"2":return"贷超信用卡"}},formatPhoneNumber:function(e){return e.mobile.replace(/(\d{3})\d{4}(\d{4})/,"$1****$2")},getLoanmarketListById:function(){var e=this;this.Api.loGetUserLoanmarketListById({mobile:this.searchForm.mobile||"",model:"0"==this.searchForm.model?"":this.searchForm.model||"",pageSize:this.defaultParams.pageSize,pageNumber:this.defaultParams.pageNumber}).then(function(t){200==t.data.code&&(e.channelList=t.data.data)})},handleAdd:function(e,t){console.log(e),console.log(this.addChannelList.length),this.addChannelList.push({mobile:"",model:"",remark:"",err:!1})},handleMinus:function(e,t){for(var a=0;a<this.addChannelList.length;a++)a==e&&this.addChannelList.splice(e,1)},searchChannel:function(){this.defaultParams.pageNumber=1,this.getLoanmarketListById()},handleCurrentChange:function(e){this.defaultParams.pageNumber=e,this.getLoanmarketListById()},handleSizeChange:function(e){this.defaultParams.pageSize=e,this.getLoanmarketListById()},deleteChannel:function(e){var t=this;this.$confirm('此操作将永久删除手机号 "'+e.mobile+'" 是否继续?',"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error",center:!0}).then(function(){t.Api.loDeleteUserLoanmarketById({userid:e.userid,id:e.id}).then(function(e){200==e.data.code?(t.$message({type:"success",message:"删除成功!"}),t.getLoanmarketListById()):t.$message({type:"error",message:e.data.msg})})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},addChannel:function(){this.addChannelDialog=!0},tableRowClassName:function(e){var t=e.row;e.rowIndex;return 1==t.err?"warning-row":""},sureSaveChannel:function(){var e=this;console.log(this.addChannelList);for(var t=0,a=0;a<this.addChannelList.length;a++)this.addChannelList[a].mobile&&this.addChannelList[a].model?(this.addChannelList[a].err=!1,t++):this.addChannelList[a].err=!0;t==this.addChannelList.length?this.Api.loInsertUserLoanmarketList({data:s()(s()(this.addChannelList))}).then(function(t){200==t.data.code?(e.$message.success("保存成功"),e.addChannelDialog=!1,e.getLoanmarketListById()):e.$message.error(t.data.msg)}):this.$message.error("请填写完整信息")},editChannel:function(e){this.editChannelForm=i()(this.editChannelForm,e),this.editChannelDialog=!0},closeDialog:function(){var e=this;n()(this.editChannelForm).forEach(function(t){e.editChannelForm[t]=""})},sureSaveEditChannel:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.Api.loSaveUserLoanmarketList({id:t.editChannelForm.id,model:t.editChannelForm.model,mobile:t.editChannelForm.mobile,remark:t.editChannelForm.remark}).then(function(e){200==e.data.code?(t.$message.success("保存成功"),t.getLoanmarketListById(),t.editChannelDialog=!1):t.$message.error(e.data.msg)})})}},created:function(){this.init()}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"blockUsers-view"},[a("div",{staticClass:"container"},[a("div",{staticClass:"plugins-tips"},[a("div",{staticClass:"plugins-search"},[a("el-form",[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"手机号",labelWidth:"60px"}},[a("el-input",{attrs:{placeholder:"请输入手机号"},model:{value:e.searchForm.mobile,callback:function(t){e.$set(e.searchForm,"mobile",t)},expression:"searchForm.mobile"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"屏蔽模块",labelWidth:"80px"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.searchForm.model,callback:function(t){e.$set(e.searchForm,"model",t)},expression:"searchForm.model"}},e._l(e.optionSearchShielding,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1),e._v(" "),a("el-col",{attrs:{span:4}},[a("el-form-item",{attrs:{label:"",labelWidth:"1px"}},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.searchChannel}},[e._v("搜索")])],1)],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"add-btn",on:{click:e.addChannel}},[a("i",{staticClass:"el-icon-lx-roundadd"}),e._v("新增屏蔽账号\n            ")])]),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.channelList.list,border:""}},[a("el-table-column",{attrs:{label:"序号",type:"index"}}),e._v(" "),a("el-table-column",{attrs:{prop:"createtime",label:"上线日期",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"mobile",label:"手机号",width:"120",formatter:e.formatPhoneNumber}}),e._v(" "),a("el-table-column",{attrs:{prop:"model",label:"屏蔽模块",formatter:e.formatModel}}),e._v(" "),a("el-table-column",{attrs:{prop:"remark",label:"备注"}}),e._v(" "),a("el-table-column",{attrs:{prop:"updatetime",label:"最后修改时间"}}),e._v(" "),a("el-table-column",{attrs:{prop:"updateby",label:"最后修改人"}}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){e.editChannel(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(a){e.deleteChannel(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("el-pagination",{attrs:{"current-page":e.defaultParams.pageNumber,"page-sizes":[10,20,30,40],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:e.channelList.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{staticClass:"addChannelDialog",attrs:{title:"新增手机号屏蔽",width:"40%",center:"",visible:e.addChannelDialog},on:{"update:visible":function(t){e.addChannelDialog=t},closed:e.closeAddChannel}},[a("el-row",{attrs:{gutter:40}},[a("el-form",[a("el-table",{staticStyle:{width:"100%"},attrs:{"row-class-name":e.tableRowClassName,data:e.addChannelList}},[a("el-table-column",{attrs:{prop:"mobile",label:"手机号",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form-item",[a("el-input",{attrs:{placeholder:"手机号"},model:{value:t.row.mobile,callback:function(a){e.$set(t.row,"mobile",a)},expression:"scope.row.mobile"}})],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"shielding",label:"屏蔽模块"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form-item",[a("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:t.row.model,callback:function(a){e.$set(t.row,"model",a)},expression:"scope.row.model"}},e._l(e.optionShielding,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"mark",label:"备注"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form-item",[a("el-input",{attrs:{placeholder:"备注"},model:{value:t.row.remark,callback:function(a){e.$set(t.row,"remark",a)},expression:"scope.row.remark"}})],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:""},scopedSlots:e._u([{key:"default",fn:function(t){return[t.$index==e.addChannelList.length-1?a("el-button",{attrs:{size:"mini",icon:"el-icon-plus"},on:{click:function(a){e.handleAdd(t.$index,t.row)}}}):e._e(),e._v(" "),e.addChannelList.length>1?a("el-button",{attrs:{size:"mini",icon:"el-icon-minus"},on:{click:function(a){e.handleMinus(t.$index,t.row)}}}):e._e()]}}])})],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.addChannelDialog=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.sureSaveChannel("addChannelForm")}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"编辑屏蔽商业渠道",width:"40%",center:"",visible:e.editChannelDialog},on:{"update:visible":function(t){e.editChannelDialog=t},closed:e.closeDialog}},[a("el-form",{ref:"editChannelForm",attrs:{model:e.editChannelForm,rules:e.editChannelRules,"label-width":"100px",size:"mini"}},[a("el-form-item",{attrs:{label:"手机号码"}},[a("el-input",{attrs:{readOnly:"",value:e.formatPhoneNumber(e.editChannelForm)}})],1),e._v(" "),a("el-form-item",{attrs:{label:"屏蔽模块",prop:"model"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.editChannelForm.model,callback:function(t){e.$set(e.editChannelForm,"model",t)},expression:"editChannelForm.model"}},e._l(e.optionShielding,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{model:{value:e.editChannelForm.remark,callback:function(t){e.$set(e.editChannelForm,"remark",t)},expression:"editChannelForm.remark"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editChannelDialog=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.sureSaveEditChannel("editChannelForm")}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var m=a("VU/8")(d,c,!1,function(e){a("peNQ")},null,null);t.default=m.exports},peNQ:function(e,t){}});