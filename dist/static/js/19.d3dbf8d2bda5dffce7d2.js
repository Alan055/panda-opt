webpackJsonp([19],{"68U/":function(e,r){},Aktw:function(e,r){},GF4k:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o={data:function(){return{ruleForm:{username:"",password:"",type:!1,product:{productId:"",productName:""}},productOption:[],dialogVisible:!1,rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],product:[{required:!0,validator:function(e,r,t){return r.productId?t():t(new Error("请选择产品"))},trigger:"change"}]}}},methods:{setProduct:function(e){console.log(e)},submitForm:function(e){var r=this;this.$refs[e].validate(function(e){if(!e)return!1;r.Api.userLogin({userName:r.ruleForm.username,password:r.ruleForm.password,productId:r.ruleForm.product.productId}).then(function(e){200==e.data.code?(r.$message.success("登录成功"),r.$store.commit("changeProductId",r.ruleForm.product),localStorage.setItem("ms_username",r.ruleForm.username),localStorage.setItem("productId",r.ruleForm.product.productId),localStorage.setItem("productName",r.ruleForm.product.productName),1==r.ruleForm.type?(localStorage.setItem("username",r.ruleForm.username),localStorage.setItem("password",r.ruleForm.password),localStorage.setItem("checkRem","1")):(localStorage.setItem("username",""),localStorage.setItem("password",""),localStorage.setItem("checkRem","0")),r.Api.userGetMenuList({}).then(function(e){var t=[];if(200==e.data.code){for(var o=e.data.data,a=0;a<o.length;a++)if("-1"==o[a].pid)t.push(o[a]);else for(var l=0;l<t.length;l++)t[l].menuId==o[a].pid&&(t[l].children?t[l].children.push(o[a]):(t[l].children=new Array,t[l].children.push(o[a])));t[0].children&&t[0].children.length>0?r.$router.push(t[0].children[0].menuUrl):r.$router.push(t[0].menuUrl)}})):r.$message.error(e.data.msg)}).catch(function(e){r.$message.error(e)})})},openDialog:function(){this.dialogVisible=!0},getProductItem:function(){var e=this;this.Api.userGetProductList({}).then(function(r){200==r.data.code&&(e.productOption=r.data.data,e.ruleForm.product=r.data.data[0])}).catch(function(r){e.$message.error(r.msg)})}},created:function(){var e=this;this.getProductItem();var r=localStorage.getItem("checkRem");setTimeout(function(){1==r?(e.ruleForm.username=localStorage.getItem("username")||"",e.ruleForm.password=localStorage.getItem("password")||"",e.ruleForm.type=!0):(e.ruleForm.username="",e.ruleForm.password="",e.ruleForm.type=!1)})}},a={render:function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"login-wrap"},[t("div",{staticClass:"ms-login"},[t("div",{staticClass:"ms-title"},[e._v("SINAIF运营后台")]),e._v(" "),t("el-form",{ref:"ruleForm",staticClass:"ms-content",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"0px"}},[t("el-form-item",{attrs:{prop:"username"}},[t("el-input",{attrs:{type:"text",tabindex:"1",placeholder:"账号"},model:{value:e.ruleForm.username,callback:function(r){e.$set(e.ruleForm,"username",r)},expression:"ruleForm.username"}},[t("el-button",{attrs:{slot:"prepend",icon:"el-icon-lx-people"},slot:"prepend"})],1)],1),e._v(" "),t("el-form-item",{attrs:{prop:"password"}},[t("el-input",{attrs:{type:"password",tabindex:"2",placeholder:"密码"},nativeOn:{keyup:function(r){if(!("button"in r)&&e._k(r.keyCode,"enter",13,r.key,"Enter"))return null;e.submitForm("ruleForm")}},model:{value:e.ruleForm.password,callback:function(r){e.$set(e.ruleForm,"password",r)},expression:"ruleForm.password"}},[t("el-button",{attrs:{slot:"prepend",icon:"el-icon-lx-lock"},slot:"prepend"})],1)],1),e._v(" "),t("el-form-item",{attrs:{prop:"product"}},[t("el-select",{attrs:{tabindex:"3",placeholder:"请选择产品","value-key":"productId"},on:{change:e.setProduct},model:{value:e.ruleForm.product,callback:function(r){e.$set(e.ruleForm,"product",r)},expression:"ruleForm.product"}},e._l(e.productOption,function(e,r){return t("el-option",{key:r,attrs:{label:e.productName,value:e}})}))],1),e._v(" "),t("el-form-item",[t("el-checkbox",{model:{value:e.ruleForm.type,callback:function(r){e.$set(e.ruleForm,"type",r)},expression:"ruleForm.type"}},[e._v("记住我的密码")]),e._v(" "),t("a",{on:{click:e.openDialog}},[e._v("忘记密码")])],1),e._v(" "),t("div",{staticClass:"login-btn"},[t("el-button",{attrs:{tabindex:"4",type:"primary"},on:{click:function(r){e.submitForm("ruleForm")}}},[e._v("登录")])],1)],1)],1),e._v(" "),t("el-dialog",{attrs:{title:"提示",visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(r){e.dialogVisible=r}}},[t("span",[e._v("如忘记密码，请联系管理员重置密码即可")]),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(r){e.dialogVisible=!1}}},[e._v("我知道了")])],1)])],1)},staticRenderFns:[]};var l=t("VU/8")(o,a,!1,function(e){t("68U/"),t("Aktw")},null,null);r.default=l.exports}});